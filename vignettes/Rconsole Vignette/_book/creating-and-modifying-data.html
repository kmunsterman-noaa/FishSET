<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>5 Creating and Modifying Data | Using FishSET in the RConsole</title>
  <meta name="description" content="5 Creating and Modifying Data | Using FishSET in the RConsole" />
  <meta name="generator" content="bookdown 0.26 and GitBook 2.6.7" />

  <meta property="og:title" content="5 Creating and Modifying Data | Using FishSET in the RConsole" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="5 Creating and Modifying Data | Using FishSET in the RConsole" />
  
  
  




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="spatial-functions.html"/>
<link rel="next" href="modeling-functions.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Welcome to FishSET</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#introduction"><i class="fa fa-check"></i><b>1.1</b> Introduction</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#getting-started"><i class="fa fa-check"></i><b>1.2</b> Getting started</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#what-is-a-project"><i class="fa fa-check"></i><b>1.3</b> What is a project?</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#chapter-overview"><i class="fa fa-check"></i><b>1.4</b> Chapter overview</a>
<ul>
<li class="chapter" data-level="1.4.1" data-path="index.html"><a href="index.html#chapter-2-data"><i class="fa fa-check"></i><b>1.4.1</b> Chapter 2 <span>Data</span></a></li>
<li class="chapter" data-level="1.4.2" data-path="index.html"><a href="index.html#chapter-3-data-exploration"><i class="fa fa-check"></i><b>1.4.2</b> Chapter 3 <span>Data Exploration</span></a></li>
<li class="chapter" data-level="1.4.3" data-path="index.html"><a href="index.html#chapter-4-spatial-functions"><i class="fa fa-check"></i><b>1.4.3</b> Chapter 4 <span>Spatial Functions</span></a></li>
<li class="chapter" data-level="1.4.4" data-path="index.html"><a href="index.html#chapter-5-creating-and-modifying-data"><i class="fa fa-check"></i><b>1.4.4</b> Chapter 5 <span>Creating and Modifying Data</span></a></li>
<li class="chapter" data-level="1.4.5" data-path="index.html"><a href="index.html#chapter-6-modeling-functions"><i class="fa fa-check"></i><b>1.4.5</b> Chapter 6 <span>Modeling Functions</span></a></li>
<li class="chapter" data-level="1.4.6" data-path="index.html"><a href="index.html#chapter-7-policy-and-welfare-analysis"><i class="fa fa-check"></i><b>1.4.6</b> Chapter 7 <span>Policy and Welfare Analysis</span></a></li>
<li class="chapter" data-level="1.4.7" data-path="index.html"><a href="index.html#chapter-8-reporting"><i class="fa fa-check"></i><b>1.4.7</b> Chapter 8 <span>Reporting</span></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="data.html"><a href="data.html"><i class="fa fa-check"></i><b>2</b> Data</a>
<ul>
<li class="chapter" data-level="2.1" data-path="data.html"><a href="data.html#required-and-optional-data"><i class="fa fa-check"></i><b>2.1</b> Required and optional data</a></li>
<li class="chapter" data-level="2.2" data-path="data.html"><a href="data.html#loading-and-reading-data"><i class="fa fa-check"></i><b>2.2</b> Loading and reading data</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="data.html"><a href="data.html#loading-data-to-the-fishset-database"><i class="fa fa-check"></i><b>2.2.1</b> Loading data to the FishSET database</a></li>
<li class="chapter" data-level="2.2.2" data-path="data.html"><a href="data.html#reading-data-into-r"><i class="fa fa-check"></i><b>2.2.2</b> Reading data into R</a></li>
<li class="chapter" data-level="2.2.3" data-path="data.html"><a href="data.html#loading-data-from-fishset-database-into-the-the-working-environment"><i class="fa fa-check"></i><b>2.2.3</b> Loading data from FishSET database into the the working environment</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="data.html"><a href="data.html#merging-gridded-and-auxiliary-data-with-the-primary-data"><i class="fa fa-check"></i><b>2.3</b> Merging gridded and auxiliary data with the primary data</a></li>
<li class="chapter" data-level="2.4" data-path="data.html"><a href="data.html#working-in-the-fishset-database"><i class="fa fa-check"></i><b>2.4</b> Working in the FishSET database</a></li>
<li class="chapter" data-level="2.5" data-path="data.html"><a href="data.html#metadata"><i class="fa fa-check"></i><b>2.5</b> Metadata</a></li>
<li class="chapter" data-level="2.6" data-path="data.html"><a href="data.html#data-management-functions"><i class="fa fa-check"></i><b>2.6</b> Data management functions</a>
<ul>
<li class="chapter" data-level="2.6.1" data-path="data.html"><a href="data.html#functions-2"><i class="fa fa-check"></i><b>2.6.1</b> Functions</a></li>
<li class="chapter" data-level="2.6.2" data-path="data.html"><a href="data.html#function-details-3"><i class="fa fa-check"></i><b>2.6.2</b> Function details</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="data-exploration.html"><a href="data-exploration.html"><i class="fa fa-check"></i><b>3</b> Data Exploration</a>
<ul>
<li class="chapter" data-level="3.1" data-path="data-exploration.html"><a href="data-exploration.html#data-exploration-functions"><i class="fa fa-check"></i><b>3.1</b> Data Exploration functions</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="spatial-functions.html"><a href="spatial-functions.html"><i class="fa fa-check"></i><b>4</b> Spatial Functions</a>
<ul>
<li class="chapter" data-level="4.1" data-path="spatial-functions.html"><a href="spatial-functions.html#mapping-functions"><i class="fa fa-check"></i><b>4.1</b> Mapping functions</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="creating-and-modifying-data.html"><a href="creating-and-modifying-data.html"><i class="fa fa-check"></i><b>5</b> Creating and Modifying Data</a>
<ul>
<li class="chapter" data-level="5.0.1" data-path="creating-and-modifying-data.html"><a href="creating-and-modifying-data.html#data-transformation-and-derivation-functions"><i class="fa fa-check"></i><b>5.0.1</b> Data transformation and derivation functions</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="modeling-functions.html"><a href="modeling-functions.html"><i class="fa fa-check"></i><b>6</b> Modeling Functions</a>
<ul>
<li class="chapter" data-level="6.1" data-path="modeling-functions.html"><a href="modeling-functions.html#modeling-functions-1"><i class="fa fa-check"></i><b>6.1</b> Modeling functions</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="policy-and-welfare-analysis.html"><a href="policy-and-welfare-analysis.html"><i class="fa fa-check"></i><b>7</b> Policy and Welfare Analysis</a></li>
<li class="chapter" data-level="8" data-path="reporting.html"><a href="reporting.html"><i class="fa fa-check"></i><b>8</b> Reporting</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Using FishSET in the RConsole</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="creating-and-modifying-data" class="section level1 hasAnchor" number="5">
<h1><span class="header-section-number">5</span> Creating and Modifying Data<a href="creating-and-modifying-data.html#creating-and-modifying-data" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="data-transformation-and-derivation-functions" class="section level3 hasAnchor" number="5.0.1">
<h3><span class="header-section-number">5.0.1</span> Data transformation and derivation functions<a href="creating-and-modifying-data.html#data-transformation-and-derivation-functions" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Several functions exist that allow users to transform variables or derive new variables and generate specific matrices. These functions are useful to ensure date variables are in the necessary format, to generate rate variables (such as catch/hours fished), calculate more complex variables such as trip distance, and adding variance to confidential data.</p>
<p>Data transformation</p>
<pre><code> set_quants()         Coded variable based on the quantiles.
 group_perc()         Within-group percentage.
 group_diff()         Within-group lagged difference.   
 group_cumsum()       Within-group running sum.</code></pre>
<p>Dummy</p>
<pre><code> dummy_num()          Vector of TRUE or FALSE, based on condition, the length (rows) of the data. 
 dummy_matrix()       Matrix with same dimensions at the data set filled with TRUE or FALSE.</code></pre>
<p>Nominal ID</p>
<pre><code> ID_var()                Generates a nominal variable to indicate distinct hauls or trips.
 create_seasonal_ID()    Generates a fishery season identifier (TRUE/FALSE).
 fleet_table()           Creates and saves a table of fleet conditions for fleet assignment.
 fleet_assign()          Creates a fleet assignment variable based on saved fleet table.</code></pre>
<p>Arithmetic</p>
<pre><code> create_var_num()     Defined arithmetic function of two variables.
 cpue()               Catch per unit effort.</code></pre>
<p>Spatial</p>
<pre><code>assignment_column()   Assign hauls to fishery or regulatory zones.
create_dist_between() Distance between lon/lat points, port, and/or centroid of fishing zone/area.
create_mid_haul()     Returns the midpoint location (lon/lat) for each haul.
create_startingloc()  Returns vector of zone/area at point when choice of where to go next was  
                      made. Used with logit_correction likelihood.</code></pre>
<p>Temporal</p>
<pre><code>temp_mod()            Transform date variable into desired units (year, month, month/day, minutes).
create_duration()     Duration of time between two temporal variables based on defined time format.</code></pre>
<p>Trip level</p>
<pre><code> haul_to_trip()       Collapse the data table from haul to trip.
 trip_distance()      Summed trip distance defined by start and end ports and hauls in between.
 trip_length()        Computes trip duration or hauls per trip. </code></pre>
<p>All functions require that <code>dat</code>, the name of the primary dataset, be specified. Use quotes if the dataset is pulled from FishSET database. Most functions in this section will add a new variable to the primary dataset. The column name of the new variables is defined with <code>name</code>. The column name defaults to the function name if <code>name</code> is not specified. Spatial functions require a spatial dataset.</p>
<p>###Function details</p>
<div id="arithmetic" class="section level4 hasAnchor" number="5.0.1.1">
<h4><span class="header-section-number">5.0.1.1</span> Arithmetic<a href="creating-and-modifying-data.html#arithmetic" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><code>create_var_num(dat, x, y, method, name)</code> creates a new numeric variable based on the defined arithmetic expression. <code>x</code> and <code>y</code> are names of numeric variables. <code>method</code> is an arithmetic expression such as addition, subtraction, multiplication, and division.<br />
<br>
<code>cpue(dat, xWeight, xTime, name)</code> creates the catch per unit effort variable. <code>xWeight</code> is the name of the variable containing the catch data as a weight (pounds, tons, metric tons). <code>xTime</code> is the duration of time and must be in weeks, days, hours, or minutes. Use <code>create_duration()</code> to transform a date variable into a duration of time variable.
If group-specific cpue is required, cpue must be calculated for each species.</p>
</div>
<div id="data-transformation" class="section level4 hasAnchor" number="5.0.1.2">
<h4><span class="header-section-number">5.0.1.2</span> Data transformation<a href="creating-and-modifying-data.html#data-transformation" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><code>group_perc(dat, project, id_group, group, value, name, create_group_ID, drop_total_col)</code> creates a within-group percentage variable using primary (<code>id_group</code>) and secondary (<code>group</code>) groups. <code>value</code> is the name of a numeric variable to be used to calculate percentages. The <code>group</code> percentage is calculated as the sum of <code>value</code> across <code>group</code> (group_total) divided by the sum of <code>value</code> across <code>id_group</code> (total_group). <code>drop_total_col</code> is logical and defines whether or not to add the total_group and group_total variables to the dataset.<br />
<br>
<code>group_diff(dat, project, group, sort_by, value, name, lag, create_group_ID, drop_total_col)</code> creates a group lagged difference variable within groups. <code>value</code>, a numeric variable, is first summed by the variable(s) in <code>group</code>, then the difference within-group is calculated. <code>sort_by</code> is a date variable to order <code>dat</code> by. The “group_total” variable gives the total value by group and can be dropped by setting <code>drop_total_col = TRUE</code>. A group ID column can be created using the variables in <code>group</code> by setting <code>create_group_ID = TRUE</code>.<br />
<br>
<code>group_cumsum(dat, project, group, sort_by, value, name, create_group_ID, drop_total_col)</code> sums <code>value</code> by group, then cumulatively sums within <code>group</code>. For example, a running sum by trip can be made by entering variables that identify unique vessels and trips into <code>group</code> and a numeric variable (such as catch or number of hauls) into <code>value</code>. The group total variable can be dropped by setting <code>drop_total_col = TRUE</code>. A group ID column can be created using the variables in group by setting <code>create_group_ID = TRUE</code>.<br />
<br>
<code>set_quants(dat, x, quant.cat = c(0.2, 0.25, 0.4), custom.quant, name)</code> transform <code>x</code> into a quantile category using pre-defined (<code>quant.cat</code>) or user-defined (<code>custom.quant</code>) quantiles.</p>
<dl>
<dt>Predefined quantiles</dt>
<dd><p>0.1 (0%, 10%, 20%, 30%, 40%, 50%, 60%, 70%, 80%, 90%, 100%)<br />
0.2 (0%, 20%, 40%, 60%, 80%, 100%)<br />
0.25 (0%, 25%, 50%, 75%, 100%)<br />
0.4 (0%, 10%, 50%, 90%, 100%)</p>
</dd>
</dl>
</div>
<div id="dummy" class="section level4 hasAnchor" number="5.0.1.3">
<h4><span class="header-section-number">5.0.1.3</span> Dummy<a href="creating-and-modifying-data.html#dummy" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><code>dummy_num(dat, var, value, opts, name)</code> creates a binary variable contrasting a variable (<code>var</code>) based on a splitting value (<code>value</code>) and splitting rule (<code>opts</code>). The function is used to contrast before/after a policy is implemented or zone closures. <code>value</code> should be a year if <code>var</code> is a date variable, a factor level if <code>var</code> is a factor variable, a single or range of numbers if <code>var</code> is a numeric variable. <code>Opts</code> may be <em>“x_y”</em> or <em>“more_less”</em>. <em>“x_y”</em> sets each element of <code>var</code> to 1 if the element matches <code>value</code>, otherwise 0. For <em>“more_less”</em>, each element of <code>var</code> less than <code>value</code> is set to 0 and all elements greater than <code>value</code> are set to 1. If <code>var</code> is a factor, then elements that match <code>value</code> will be set to 1 and all other elements set to 0. Default is set to <em>“more_less”</em>.<br />
<br>
<code>dummy_matrix(dat, x)</code> creates a dummy matrix of TRUE/FALSE based on values of variable <code>x</code> with dimensions <em>(number of observations in dataset)</em> (number of factors in x)* where each column is a unique factor level of <code>x</code>. Values are TRUE if the value in the column matches the column factor level and FALSE otherwise.</p>
</div>
<div id="nominal-id" class="section level4 hasAnchor" number="5.0.1.4">
<h4><span class="header-section-number">5.0.1.4</span> Nominal ID<a href="creating-and-modifying-data.html#nominal-id" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><code>ID_var(dat, vars, name, type, drop)</code> is used to create a haul or trip identifier variable from on or more variables (<code>vars</code>). <code>type</code> is the class type of the new ID column. Choices are <em>“string”</em> and <em>“integer”</em>. <em>“string”</em> returns a character vector where each column in <code>vars</code> is combined and separated with an underscore "_". <em>“integer”</em> returns an integer vector where each value corresponds to a unique group in <code>vars</code>. Set <code>drop = TRUE</code> to drop <code>vars</code> columns from <code>dat</code>.<br />
<br>
<code>create_seasonal_ID(dat, seasonal.dat, use.location, use.geartype, sp.col, target)</code> uses a table of fishery season dates to create one or more fishery season identifier variables. The function matches fishery season dates provided in <code>seasonal.dat</code> to the first date variable in <code>dat</code>. If fishery season dates vary by location or gear type, set <code>use.location = TRUE</code> and <code>use.geartype = TRUE</code>. Output is a seasonID variable and/or multiple <em>seasonID*fishery</em> variables. The seasonID variable is a vector of fisheries. If a target fishery (<code>target</code>) is not defined, each row is the first observed fishery in <code>seasonal.dat</code> for which the fishery season dates encompasses date in <code>dat</code>. If target fishery is defined, then SeasonID is defined by whether the target fishery is open on the date in <code>dat</code> or a different fishery. The vector is filled with <em>“target”</em> or <em>“other”</em>. <em>SeasonID*fishery</em> variables are a TRUE/FALSE seasonID vector for each fishery (labeled by seasonID and fishery) where TRUE indicates the dates for a given row in the main data table fall within the fishery dates for that fishery.</p>
</div>
<div id="spatial" class="section level4 hasAnchor" number="5.0.1.5">
<h4><span class="header-section-number">5.0.1.5</span> Spatial<a href="creating-and-modifying-data.html#spatial" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><code>assignment_column(dat, project, gridfile, lon.dat, lat.dat, cat, closest.pt = FALSE, lon.grid = NULL, lat.grid = NULL, hull.polygon = FALSE, epsg = NULL)</code> assigns observations (hauls) to zones. <code>gridfile</code> is the spatial dataset defining zone boundaries, <code>lon.dat</code> and <code>lat.dat</code> are variables in <code>dat</code> used to assign each observation to a zone. <code>cat</code> is a variable or list in <code>gridfile</code> that identifies the individual areas or zones. <code>lon.grid</code> and <code>lat.grid</code>are properties or lists from <code>gridfile</code> containing longitude and latitude data. These data are required if <code>gridfile</code> is not class <em>sf</em>. <code>hull.polygon</code> and <code>closest.pt</code> are logical optional arguments. Set <code>hull.polygon = TRUE</code> if spatial data creating polygons are sparse or irregular. To assign observations that fall outside any zones to the closest zone polygon set <code>closest.pt = TRUE</code>. <code>epsg</code> is the spatial reference system. Specify <a href="http://spatialreference.org"><code>epsg</code></a> if the projected coordinate systems do not match.<br />
<br>
<code>create_dist_between(dat, start, end, units, name)</code> adds a distance between two points variable to <code>dat</code>. <code>start</code> and <code>end</code> locations define how to find the lon/lat of starting and ending locations. Options are a port (specify port variable name), observed latitude and longitude location (specify variable name containing longitude data then latitude data as a character string), or the centroid of the observed fishery zone location (specify ‘centroid’). Distance is returned in the requested <code>units</code> (<em>“miles”, “kilometers”, “midpoint”</em>).
Additional arguments may be required, depending upon the <code>start</code> and <code>end</code> arguments. These are added through prompts.</p>
<dl>
<dt>Additional arguments</dt>
<dd><p><em>Port arguments</em><br />
portTable - Table contains the latitude and longitude of ports.</p>
</dd>
<dd><p><em>Centroids arguments</em><br />
gridfile - Spatial data file.<br />
lon.dat - Longitude variable from dat.<br />
lat.dat - Latitude variable from dat.<br />
lon.grid - Property or variable from gridfile containing longitude data.<br />
lat.grid - Property or variable from gridfile containing latitude data.<br />
cat - Property or variable from gridfile that identifies the individual areas or zones.<br />
<br></p>
</dd>
</dl>
<p><code>create_mid_haul(dat, start=c("lon", "lat"), end=c("lon", "lat"), name)</code> returns the latitude and longitude of the midpoint location of each haul. Each row of <code>dat</code> must be a unique haul. Requires a <code>start</code> and <code>end</code> point for each observation. <code>start</code> and <code>end</code> must be specified in the order of longitude then latitude.<br />
<br></p>
<p><code>create_startingloc(dat, gridfile, portTable, trip_id, haul_order, starting_port, lon.dat, lat.dat, cat, name, lon.grid, lat.grid)</code> creates a variable containing the zone/area location of a vessel when choice of where to fish next was made. This variable is required for the full information model with Dahl’s correction (logit_correction). Unique trips in <code>dat</code> are identified with <code>trip_id</code>. <code>haul_order</code> identifies the order of hauls within <code>trip_id</code>. Generally, the first zone of a trip is the departure port and is identified with <code>starting_port</code>. <code>gridfile</code> and <code>portTable</code> are additional data tables containing information on zone boundaries and port locations, respectively. These two data tables along with <code>lon.dat</code>, <code>lat.dat</code>, <code>cat</code>, <code>lon.grid</code>, and <code>lat.grid</code> are called by the <code>assignment_column()</code> function to assign starting port locations and haul locations to zones. <code>lon.grid</code> and <code>lat.grid</code> are required if <code>gridfile</code> is a data frame or list.</p>
</div>
<div id="temporal" class="section level4 hasAnchor" number="5.0.1.6">
<h4><span class="header-section-number">5.0.1.6</span> Temporal<a href="creating-and-modifying-data.html#temporal" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><code>temporal_mod(dat, x, define.format, name)</code> extracts a time unit from <code>x</code>, date variable in <code>dat</code>, in the desired format (<code>define.format</code>). The FishSET function <code>date_parser()</code> is first called to convert the date variable into recognized class if required. The <code>as.Date()</code> function from the <a href="https://www.rdocumentation.org/packages/base/versions/3.6.2/topics/as.Date">base package</a> is then called to extract the time in the desired format. <code>define.format</code> can be a predefined format (see below) or <a href="https://www.stat.berkeley.edu/~s133/dates.html">user-defined</a>.</p>
<p>Predefined formats:</p>
<pre><code>Value    as.Date format      Output   
_______________________________________________________________
year    &quot;%Y&quot;                 year
month   &quot;%Y/%m&quot;              year and month
day     &quot;%Y/%m/%d&quot;           year, month, and day
hour    &quot;%Y/%m/%d %H&quot;        year, month, day and hour
minute  “%Y/%m/%d %H:%M&quot;     year, month, day, hour, and minute</code></pre>
<p><br>
<code>create_duration(dat, start, end, units=c("week", "day", "hour", "minute"), name)</code> returns the duration of time, in specified <code>units</code>, between two temporal variables (<code>start</code>, <code>end</code>) in <code>dat</code>. A duration of time variable is required for other functions, such as <code>cpue()</code>.</p>
</div>
<div id="trip-level" class="section level4 hasAnchor" number="5.0.1.7">
<h4><span class="header-section-number">5.0.1.7</span> Trip-level<a href="creating-and-modifying-data.html#trip-level" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><code>haul_to_trip(dat, project, fun.numeric, fun.time, tripID)</code> collapses <code>dat</code> from haul to trip level. Unique trips are identified by <code>tripID</code>. <code>tripID</code> may be one or more variables from <code>dat</code>. <code>fun.numeric</code> and <code>fun.time</code> define how multiple observations for a trip are collapsed. Options are <em>min</em>, <em>mean</em>, <em>max</em>, and <em>sum</em> for numeric variables and <em>min</em>, <em>mean</em>, and <em>max</em> for temporal variables. For variables that are not numeric or dates, the first observation is used.<br />
<br>
<code>create_trip_distance(dat, PortTable, trip_id, starting_port, starting_haul = c("Lon", "Lat"), ending_haul = c("Lon", "Lat"), ending_port, haul_order, name, a = 6378137, f = 1/298.257223563)</code> sums distance across a trip based on starting and ending ports and hauls in between. Inputs are the trips, ports, and hauls from the primary dataset, and the latitude and longitude of ports from the <code>PortTable</code>. The ellipsoid arguments, <code>a</code> and <code>f</code>, can be changed if an ellipsoid other than WGS84 is appropriate. See the <a href="https://cran.r-project.org/web/packages/geosphere/geosphere.pdf">geosphere R package</a>.<br />
<br>
<code>create_trip_centroid(dat, lon, lat, weight.var, ...)</code> returns the centroid, in longitude and latitude, for each trip. Specify a weighting variable (<code>weight.var</code>) to calculate the weighted centroid. Additional arguments can be added that define unique trips. If no additional arguments are added, each row will be treated as a unique trip.</p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="spatial-functions.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="modeling-functions.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
